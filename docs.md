- **デプロイはせず、localhostでの実行のみを想定してください**

# 前提知識
- 与えられる問題urlは、https://atcoder.jp/contests/{contst_id}/tasks/{contest_id}_{problem_id} のような形式です。(例：https://atcoder.jp/contests/abc416/tasks/abc416_a)
  - problem-example.html は、この形式の問題url先のhtmlファイルです。
- また、これに対応する提出urlは、https://atcoder.jp/contests/{contest_id}/submissions?f.LanguageName=&f.Status=&f.Task={contest_id}_{problem_id}&f.User=&page={page_number} のような形式です。(例：https://atcoder.jp/contests/abc416/submissions?f.LanguageName=&f.Status=&f.Task=abc416_a&f.User=&page=2)
  - submissions-example.html は、この形式の提出url先のhtmlファイルです。
- 順位表更新時、pageは、当該ページの提出のうちもっとも提出時間が早い提出がコンテスト開始時間以降である限り、次のpageに移動していきます(これがコンテスト開始時間以前になった場合、クロールを終了します)

# 技術選定
- フロントエンド・バックエンド共にtypescript
  - UIはMUIベース、サーバフレームワークはNext.js
- データベースパスワード等は.envに記載
- データベースはRDBで、PostgreSQLを使用
- 実行の際は、dockerを使用し、5050番ポートで実行してください
- 必要なライブラリのインストールは、適宜通知してください(私が許可するか判断します)
- また、データベースの操作においては、SQL文を直接書かず、何らかのライブラリを使用(あるいは作成)してください

# データベース設計
- コンテストIDはUUIDで生成
  - contest/
    - id : UUID
    - name : コンテスト名
    - created_at : 作成日時
    - updated_at : 更新日時
    - problems/
      - name : 問題名
      - problem_url : 問題url
      - submission_url : 提出url
      
# 全体のディレクトリ構造
- src/
  - frontend/
    - 中身は適宜ここに記載してください
  - backend/
    - 中身は適宜ここに記載してください
- db/
  - app.db

# UI一覧
- コンテスト一覧画面
- コンテスト管理画面
- 順位表画面

## コンテスト一覧画面
- コンテスト一覧
- コンテスト追加フォーム(コンテスト名を入力すると、コンテストが作成される。コンテスト名の重複は禁止)
- ×ボタンを押すと、コンテスト一覧から削除される(データベースからの物理削除)

## コンテスト管理画面
- 問題一覧
  - A or B or ...と、問題名と問題urlを表示
  - 順番を入れ替え可能にして、入れ替えにおいては、問題だけをドラッグすることとし、A, B, ...のラベルは定位置に固定する
  - ×ボタンを押すと、問題一覧から削除される(データベースからの物理削除)
- 問題追加フォーム
  - URLと得点を入力
  - 追加ボタンを押すとスクレイピングが実行され、問題名と、submissionURLが取得され、問題一覧に追加される
  - 同一urlを持つ問題は、追加できないようにする
- ユーザー一覧
  - AtCoderIDの一覧を表示(Alphabetical order)
  - ×ボタンを押すと、ユーザー一覧から削除される(データベースからの物理削除)
- ユーザー追加フォーム
  - AtCoderIDを入力すると、ユーザー一覧に追加される
  - 同一AtCoderIDを持つユーザーは、追加できないようにする

## 順位表画面
- 順位表の更新は3分毎(順位表取得をフロントエンドから定期的に叩き、順位表を更新する)
- 順位表のexcel export機能を付ける
- 順位表
  - 参加人数を $n$ , 問題数を $k$ としたとき、 $n$ 行 $k+3$ 列の表形式
  - 1行目はヘッダー(「順位」・「ユーザ名」・「得点」・A, B, C, ...)で、2行目以降は、各ユーザーの順位・ユーザー名・全体としてのスコア・各問題の回答時間
  - 全体としてのスコアの形式は以下
    - ACを得られている問題の総得点を表示
    - ACを得ている問題のうち、最初のAC提出時間がもっとも遅い問題の提出時間 + すべての問題のペナルティ(ACを得ている場合かつCE以外のエラーの個数)数の合計 * 5分 を表示
    - ペナルティがある場合は、その数を総得点の左側に小さく赤字で表示
    - 例：A: 100点 (1WA, 30:00時点), B: 200点 (2WA, 40:20時点), C: 300点 (0WA, 35:00時点), D: 400点(2WAだがACは得られていない)
      の時、総得点は600, ペナルティ数は3, 表示分数は 40:20 + 3 * 5分 = 55:20
    - 順位はこの情報によって決まり、得点が高いほうが順位が高い。得点が同じ場合は、ペナルティ込みの分数が低いほうが順位が高い。ペナルティ込みの分数が同じ場合は、同順位とする
  - 各問題に対する表示は、以下の形式
    - CE以外の提出が無ければ空欄
    - ACを得られていない場合, CE以外の提出の個数を丸かっこに囲んで表示(1RE, 1TLE, 2WA → (4))
    - ACを得られている場合、得点を表示

# 必要なapi
- コンテスト一覧画面
  - コンテスト一覧の取得
  - コンテストの追加
  - コンテストの削除(物理削除)

以下はすべて特定のコンテストに対する操作 (uriパラメータにコンテストidを含む)
- コンテスト管理画面
  - 問題一覧の取得
  - 問題の追加
  - 問題の削除(物理削除)
  - ユーザー一覧の取得
  - ユーザーの追加
  - ユーザーの削除(物理削除)
- 順位表画面
  - 順位表の取得
  - 順位表の更新
  - 順位表のexcel export

# 必要実装
- 実装にあたっては、必要に応じて、ソースコードを分離するほか、共有資源の再利用性を意識すること。
- また、以下のチェックリストを満たし、必要に応じてサブタスク(コンポーネントの分解や共有資源の分離)を記載したうえで、実装を進めること。
- フロントエンド
  - 機能に応じてディレクトリを分離すること(hook, components, pages, utils, types, api, etc...(必要以上に複雑にはしなくてよいです))
  - [ ] コンテスト一覧画面
  - [ ] コンテスト管理画面
  - [ ] 順位表画面
- バックエンド
  - 機能に応じてディレクトリを分離すること
  - [ ] コンテスト追加削除等のためのAPI
  - [ ] 問題管理用API
  - [ ] ユーザ管理用API
  - [ ] 順位表の更新・取得のためのAPI
  - [ ] 順位表のexcel exportのためのAPI
- 使用方法を記したmarkdownファイル(README.mdの書き換えでOK)
